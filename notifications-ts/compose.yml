services:
  db:
    build:
      context: ../accounting/docker/db
    ports:
      - "5433:5432"
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: notifications
      POSTGRES_APP_USER: notifications
      POSTGRES_APP_PASSWORD: notifications
      # Backup settings (optional for dev but keeps image happy)
      WALG_GS_PREFIX: "gs://bucket/db-notifications"
      GOOGLE_APPLICATION_CREDENTIALS: "/opt/komunitin-project-backup-credentials.json"
    volumes:
      - db-data:/var/lib/postgresql/data
      # Mount a dummy or real creds file if image requires it to start, 
      # though usually only needed for backup scripts. 
      # We'll touch a dummy file if needed.
    networks:
      - default

volumes:
  db-data:
